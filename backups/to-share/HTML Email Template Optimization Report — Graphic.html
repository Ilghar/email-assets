
<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HTML Email Template Optimization Report</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.6.1/mermaid.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Tiempos+Headline:wght@400;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #7c3aed;
            --primary-dark: #5b21b6;
            --secondary: #f3f4f6;
            --accent: #e5e7eb;
            --text-primary: #1f2937;
            --text-secondary: #6b7280;
            --bg-primary: #ffffff;
            --bg-secondary: #f9fafb;
        }
        
        * {
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            line-height: 1.7;
            color: var(--text-primary);
            background-color: var(--bg-secondary);
            max-width: 100%;
            overflow-x: hidden;
        }
        
        img {
            max-width: 100%;
            height: auto;
        }
        
        .serif {
            font-family: 'Tiempos Headline', serif;
        }
        
        .toc-fixed {
            position: fixed;
            left: 0;
            top: 0;
            width: 280px;
            height: 100vh;
            background: var(--bg-primary);
            border-right: 1px solid var(--accent);
            overflow-y: auto;
            z-index: 1000;
            padding: 2rem 1.5rem;
            box-shadow: 2px 0 10px rgba(0,0,0,0.05);
        }
        
        .main-content {
            margin-left: 280px;
            min-height: 100vh;
        }
        
        .hero-section {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            position: relative;
            overflow: hidden;
        }
        
        .hero-overlay {
            position: absolute;
            inset: 0;
            background: rgba(0,0,0,0.3);
            z-index: 1;
        }
        
        .hero-content {
            position: relative;
            z-index: 2;
        }
        
        .bento-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
            align-items: start;
        }
        
        .toc-link {
            display: block;
            padding: 0.5rem 0;
            color: var(--text-secondary);
            text-decoration: none;
            border-left: 2px solid transparent;
            padding-left: 1rem;
            transition: all 0.2s ease;
        }
        
        .toc-link:hover {
            color: var(--primary);
            border-left-color: var(--primary);
            background: rgba(124, 58, 237, 0.05);
        }
        
        .toc-link.active {
            color: var(--primary);
            border-left-color: var(--primary);
            font-weight: 600;
        }
        
        .section-header {
            border-bottom: 3px solid var(--primary);
            padding-bottom: 1rem;
            margin-bottom: 2rem;
        }
        
        .priority-badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        
        .priority-p1 {
            background: #fee2e2;
            color: #dc2626;
        }
        
        .priority-p2 {
            background: #fef3c7;
            color: #d97706;
        }
        
        .client-tier {
            background: #e0e7ff;
            color: #4338ca;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            font-weight: 500;
            margin: 0.25rem 0;
        }
        
        .code-block {
            background: #1e293b;
            color: #e2e8f0;
            padding: 1.5rem;
            border-radius: 0.5rem;
            overflow-x: auto;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 0.875rem;
            line-height: 1.6;
        }
        
        .citation {
            color: var(--primary);
            text-decoration: none;
            font-weight: 500;
            border-bottom: 1px dotted var(--primary);
        }
        
        .citation:hover {
            background: rgba(124, 58, 237, 0.1);
            padding: 0.125rem 0.25rem;
            border-radius: 0.25rem;
        }
        
        .insight-card {
            background: white;
            border-left: 4px solid var(--primary);
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 0 0.5rem 0.5rem 0;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        .mermaid-container {
            display: flex;
            justify-content: center;
            min-height: 300px;
            max-height: 800px;
            background: #ffffff;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            padding: 30px;
            margin: 30px 0;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08);
            position: relative;
            overflow: hidden;
        }

        .mermaid-container .mermaid {
            width: 100%;
            max-width: 100%;
            height: 100%;
            cursor: grab;
            transition: transform 0.3s ease;
            transform-origin: center center;
            display: flex;
            justify-content: center;
            align-items: center;
            touch-action: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        .mermaid-container .mermaid svg {
            max-width: 100%;
            height: 100%;
            display: block;
            margin: 0 auto;
        }

        .mermaid-container .mermaid:active {
            cursor: grabbing;
        }

        .mermaid-container.zoomed .mermaid {
            height: 100%;
            width: 100%;
            cursor: grab;
        }

        .mermaid-controls {
            position: absolute;
            top: 15px;
            right: 15px;
            display: flex;
            gap: 10px;
            z-index: 20;
            background: rgba(255, 255, 255, 0.95);
            padding: 8px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .mermaid-control-btn {
            background: #ffffff;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            padding: 10px;
            cursor: pointer;
            transition: all 0.2s ease;
            color: #374151;
            font-size: 14px;
            min-width: 36px;
            height: 36px;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .mermaid-control-btn:hover {
            background: #f8fafc;
            border-color: #3b82f6;
            color: #3b82f6;
            transform: translateY(-1px);
        }

        .mermaid-control-btn:active {
            transform: scale(0.95);
        }
        
        /* Override mermaid default styles for better contrast and unified styling */
        .mermaid .node rect,
        .mermaid .node circle,
        .mermaid .node ellipse,
        .mermaid .node polygon {
            stroke-width: 2px !important;
        }
        
        .mermaid .node .label {
            color: #1f2937 !important;
            font-weight: 500 !important;
            font-size: 14px !important;
            font-family: 'Inter', sans-serif !important;
        }
        
        .mermaid .edgePath .path {
            stroke-width: 2px !important;
            stroke: #6b7280 !important;
        }
        
        .mermaid .edgeLabel {
            background-color: white !important;
            border: 1px solid #d1d5db !important;
            border-radius: 6px !important;
            padding: 4px 8px !important;
            font-size: 12px !important;
            color: #374151 !important;
            font-weight: 500 !important;
            font-family: 'Inter', sans-serif !important;
        }
        
        /* Color-specific styling for different node types */
        .mermaid .node.tier1 rect {
            fill: #fef3c7 !important;
            stroke: #d97706 !important;
        }
        
        .mermaid .node.tier1 .label {
            color: #92400e !important;
        }
        
        .mermaid .node.tier2 rect {
            fill: #dbeafe !important;
            stroke: #2563eb !important;
        }
        
        .mermaid .node.tier2 .label {
            color: #1d4ed8 !important;
        }
        
        .mermaid .node.p1issue rect {
            fill: #fee2e2 !important;
            stroke: #dc2626 !important;
        }
        
        .mermaid .node.p1issue .label {
            color: #991b1b !important;
        }
        
        .mermaid .node.p2issue rect {
            fill: #f0fdf4 !important;
            stroke: #16a34a !important;
        }
        
        .mermaid .node.p2issue .label {
            color: #15803d !important;
        }
        
        @media (max-width: 1024px) {
            .toc-fixed {
                transform: translateX(-100%);
                transition: transform 0.3s ease;
            }
            
            .toc-fixed.open {
                transform: translateX(0);
            }
            
            .main-content {
                margin-left: 0;
            }
            
            .bento-grid {
                grid-template-columns: 1fr;
            }
            
            .mermaid-control-btn:not(.reset-zoom) {
                display: none;
            }
            .mermaid-controls {
                top: auto;
                bottom: 15px;
                right: 15px;
            }
        }
        
        @media (max-width: 768px) {
            .hero-section .flex {
                flex-direction: column;
            }
            .hero-section .flex > div {
                width: 100%;
            }
            #hero h1 {
                font-size: 2.5rem;
                line-height: 1.2;
            }
            #hero p.text-lg {
                font-size: 1rem;
            }
        }
    </style>
  <base target="_blank">
</head>

  <body>
    <!-- Fixed Table of Contents -->
    <nav class="toc-fixed">
      <div class="mb-8">
        <h3 class="serif text-lg font-bold text-gray-900 mb-4">Table of Contents</h3>
        <div class="space-y-1">
          <a href="#hero" class="toc-link">Executive Summary</a>
          <a href="#executive-triage" class="toc-link">Executive Triage</a>
          <a href="#surgical-fixes" class="toc-link">Surgical Fixes</a>
          <a href="#dark-mode" class="toc-link ml-4">• Dark Mode Fidelity</a>
          <a href="#job-titles" class="toc-link ml-4">• Job Titles Wrapping</a>
          <a href="#font-scaling" class="toc-link ml-4">• Umwelt Panel Scaling</a>
          <a href="#outlook-issues" class="toc-link ml-4">• Outlook Rendering</a>
          <a href="#inline-styles" class="toc-link ml-4">• Inline Color Styling</a>
          <a href="#sanity-checklist" class="toc-link">Sanity Checklist</a>
          <a href="#implementation" class="toc-link">Implementation Guide</a>
        </div>
      </div>

      <div class="mt-8 pt-8 border-t border-gray-200">
        <h4 class="text-sm font-semibold text-gray-700 mb-3">Quick Stats</h4>
        <div class="space-y-2 text-xs text-gray-600">
          <div class="flex justify-between">
            <span>Test Coverage:</span>
            <span class="font-medium">209 checks</span>
          </div>
          <div class="flex justify-between">
            <span>Compatibility:</span>
            <span class="font-medium text-green-600">89-90%</span>
          </div>
          <div class="flex justify-between">
            <span>P1 Issues:</span>
            <span class="font-medium text-red-600">3 critical</span>
          </div>
          <div class="flex justify-between">
            <span>P2 Issues:</span>
            <span class="font-medium text-yellow-600">3 notable</span>
          </div>
        </div>
      </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
      <!-- Hero Section -->
      <section id="hero" class="hero-section py-16 px-8">
        <div class="hero-overlay"></div>
        <div class="hero-content max-w-6xl mx-auto">
          <div class="bento-grid">
            <!-- Main Title Block -->
            <div class="space-y-6">
              <h1 class="serif text-4xl lg:text-5xl font-bold leading-tight">
                <em class="italic">HTML Email Template</em>
                <br>
                Optimization Report
              </h1>
              <p class="text-xl text-gray-200 max-w-lg">
                A comprehensive analysis of rendering issues across 209 email client checks,
                with surgical fixes for dark mode fidelity, layout stability, and cross-client compatibility.
              </p>
            </div>

            <!-- Key Metrics Block -->
            <div class="bg-white/10 backdrop-blur-sm rounded-lg p-6">
              <h3 class="text-lg font-semibold mb-4">Critical Issues Overview</h3>
              <div class="space-y-4">
                <div class="flex items-center justify-between">
                  <span class="text-sm">Dark Mode Rendering</span>
                  <span class="priority-badge priority-p1">P1</span>
                </div>
                <div class="flex items-center justify-between">
                  <span class="text-sm">Job Title Wrapping</span>
                  <span class="priority-badge priority-p1">P1</span>
                </div>
                <div class="flex items-center justify-between">
                  <span class="text-sm">Font Scaling Issues</span>
                  <span class="priority-badge priority-p1">P1</span>
                </div>
                <div class="flex items-center justify-between">
                  <span class="text-sm">Outlook Clipping</span>
                  <span class="priority-badge priority-p2">P2</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Executive Triage Section -->
      <section id="executive-triage" class="py-16 px-8 bg-white">
        <div class="max-w-6xl mx-auto">
          <div class="section-header">
            <h2 class="serif text-3xl font-bold">S1 — Executive Triage</h2>
            <p class="text-gray-600 mt-2">A high-level overview of critical issues prioritized by impact and client prevalence.</p>
          </div>

          <div class="grid lg:grid-cols-2 gap-8 mb-12">
            <!-- Client Tier Breakdown -->
            <div class="insight-card">
              <h3 class="text-lg font-semibold mb-4">Client Tier Classification</h3>
              <div class="space-y-3">
                <div>
                  <h4 class="font-semibold text-amber-800 mb-2">Tier-1 (Must Be Perfect)</h4>
                  <div class="space-y-1">
                    <div class="client-tier">Apple Mail (iOS/macOS)</div>
                    <div class="client-tier">Gmail (Web + Mobile)</div>
                    <div class="client-tier">Outlook Desktop</div>
                    <div class="client-tier">Outlook.com</div>
                    <div class="client-tier">ProtonMail</div>
                  </div>
                </div>
                <div>
                  <h4 class="font-semibold text-blue-800 mb-2">Tier-2 (Should Be Solid)</h4>
                  <div class="space-y-1">
                    <div class="client-tier">Yahoo Mail</div>
                    <div class="client-tier">GMX</div>
                    <div class="client-tier">Android Webmail</div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Issue Priority Matrix -->
            <div class="insight-card">
              <h3 class="text-lg font-semibold mb-4">Issue Priority Matrix</h3>
              <div class="space-y-4">
                <div>
                  <div class="flex items-center mb-2">
                    <span class="priority-badge priority-p1 mr-2">P1</span>
                    <span class="font-semibold">Critical Breakage</span>
                  </div>
                  <ul class="text-sm text-gray-600 space-y-1 ml-2">
                    <li>• Layout collapse</li>
                    <li>• Text invisibility</li>
                    <li>• Color contrast failures</li>
                    <li>• Content unreadability</li>
                  </ul>
                </div>
                <div>
                  <div class="flex items-center mb-2">
                    <span class="priority-badge priority-p2 mr-2">P2</span>
                    <span class="font-semibold">Noticeable Degradation</span>
                  </div>
                  <ul class="text-sm text-gray-600 space-y-1 ml-2">
                    <li>• Minor visual artifacts</li>
                    <li>• Styling inconsistencies</li>
                    <li>• Suboptimal rendering</li>
                    <li>• Maintainability issues</li>
                  </ul>
                </div>
              </div>
            </div>
          </div>

          <!-- Client vs Issue Matrix -->
          <div class="bg-gray-50 rounded-lg p-6">
            <h3 class="text-lg font-semibold mb-4">Client × Issue Impact Matrix</h3>
            <div class="overflow-x-auto">
              <table class="w-full text-sm">
                <thead>
                  <tr class="border-b border-gray-200">
                    <th class="text-left py-3 px-4 font-semibold">Client</th>
                    <th class="text-center py-3 px-4 font-semibold">Dark Mode</th>
                    <th class="text-center py-3 px-4 font-semibold">Job Titles</th>
                    <th class="text-center py-3 px-4 font-semibold">Font Scaling</th>
                    <th class="text-center py-3 px-4 font-semibold">Outlook Issues</th>
                  </tr>
                </thead>
                <tbody class="divide-y divide-gray-200">
                  <tr>
                    <td class="py-3 px-4 font-medium">Apple Mail</td>
                    <td class="py-3 px-4 text-center"><span class="priority-badge priority-p1">P1</span></td>
                    <td class="py-3 px-4 text-center"><span class="priority-badge priority-p2">P2</span></td>
                    <td class="py-3 px-4 text-center"><span class="priority-badge priority-p1">P1</span></td>
                    <td class="py-3 px-4 text-center">-</td>
                  </tr>
                  <tr>
                    <td class="py-3 px-4 font-medium">Gmail Mobile</td>
                    <td class="py-3 px-4 text-center"><span class="priority-badge priority-p1">P1</span></td>
                    <td class="py-3 px-4 text-center"><span class="priority-badge priority-p2">P2</span></td>
                    <td class="py-3 px-4 text-center"><span class="priority-badge priority-p1">P1</span></td>
                    <td class="py-3 px-4 text-center">-</td>
                  </tr>
                  <tr>
                    <td class="py-3 px-4 font-medium">Outlook Desktop</td>
                    <td class="py-3 px-4 text-center"><span class="priority-badge priority-p1">P1</span></td>
                    <td class="py-3 px-4 text-center"><span class="priority-badge priority-p2">P2</span></td>
                    <td class="py-3 px-4 text-center"><span class="priority-badge priority-p1">P1</span></td>
                    <td class="py-3 px-4 text-center"><span class="priority-badge priority-p1">P1</span></td>
                  </tr>
                  <tr>
                    <td class="py-3 px-4 font-medium">Yahoo Mail</td>
                    <td class="py-3 px-4 text-center"><span class="priority-badge priority-p2">P2</span></td>
                    <td class="py-3 px-4 text-center">-</td>
                    <td class="py-3 px-4 text-center"><span class="priority-badge priority-p2">P2</span></td>
                    <td class="py-3 px-4 text-center">-</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>

          <!-- Decision Framework -->
          <div class="mt-12">
            <h3 class="text-xl font-semibold mb-6">Decision Framework: Fix Now vs. Defer</h3>
            <div class="grid md:grid-cols-2 gap-6">
              <div class="bg-red-50 border border-red-200 rounded-lg p-6">
                <h4 class="text-lg font-semibold text-red-800 mb-3">
                  <i class="fas fa-exclamation-triangle mr-2"></i>Immediate Action Required (P1)
                </h4>
                <ul class="space-y-2 text-sm text-red-700">
                  <li>• <strong>Dark Mode Fidelity:</strong> Unwanted color inversions making text invisible</li>
                  <li>• <strong>Job Title Wrapping:</strong> Footer layout breaking on mobile devices</li>
                  <li>• <strong>Umwelt Font Scaling:</strong> Hierarchy disruption on small screens</li>
                  <li>• <strong>Outlook Rendering:</strong> Text and image clipping issues</li>
                </ul>
              </div>
              <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-6">
                <h4 class="text-lg font-semibold text-yellow-800 mb-3">
                  <i class="fas fa-clock mr-2"></i>Best Effort/Graceful Degradation (P2)
                </h4>
                <ul class="space-y-2 text-sm text-yellow-700">
                  <li>• <strong>Inline Styles:</strong> Migrate to class-based system for maintainability</li>
                  <li>• <strong>Minor Visual Artifacts:</strong> Address after critical fixes</li>
                  <li>• <strong>Advanced CSS Effects:</strong> Accept fallback behavior in older clients</li>
                  <li>• <strong>Code Optimization:</strong> Progressive enhancement approach</li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Surgical Fixes Section -->
      <section id="surgical-fixes" class="py-16 px-8 bg-gray-50">
        <div class="max-w-6xl mx-auto">
          <div class="section-header">
            <h2 class="serif text-3xl font-bold">S2 — Surgical Fixes</h2>
            <p class="text-gray-600 mt-2">Targeted code changes with minimal footprint and maximum impact.</p>
          </div>

          <!-- Dark Mode Fidelity Fix -->
          <div id="dark-mode" class="mb-16">
            <div class="bg-white rounded-lg shadow-sm border">
              <div class="p-6 border-b border-gray-200">
                <div class="flex items-center justify-between">
                  <div>
                    <h3 class="text-xl font-semibold">Dark-Mode Color Fidelity</h3>
                    <p class="text-gray-600 mt-1">Preventing unwanted color inversions across email clients</p>
                  </div>
                  <span class="priority-badge priority-p1">P1 Issue</span>
                </div>
              </div>

              <div class="p-6 space-y-6">
                <div>
                  <h4 class="font-semibold mb-2">Symptom Analysis</h4>
                  <p class="text-gray-700 mb-4">
                    Automatic color inversion in dark mode creates poor contrast and breaks branding.
                    Gmail mobile and Outlook desktop are particularly problematic with their unique
                    dark mode implementations <a href="https://www.emailonacid.com/blog/article/email-development/dark-mode-for-email/" class="citation" target="_blank">[283]</a>.
                  </p>

                  <div class="bg-amber-50 border border-amber-200 rounded-lg p-4">
                    <h5 class="font-semibold text-amber-800 mb-2">Affected Clients:</h5>
                    <ul class="text-sm text-amber-700 space-y-1">
                      <li>• Gmail mobile (iOS/Android) - partial color inversion</li>
                      <li>• Outlook desktop - unpredictable background changes</li>
                      <li>• Apple Mail - data detector link styling issues</li>
                      <li>• ProtonMail - aggressive dark theme application</li>
                    </ul>
                  </div>
                </div>

                <div>
                  <h4 class="font-semibold mb-2">Multi-Layered Solution</h4>
                  <div class="space-y-4">
                    <div>
                      <h5 class="font-medium mb-2">1. Meta Tags for Color Scheme</h5>
                      <div class="code-block">
                        &lt;meta name="color-scheme" content="light dark"&gt;
                        &lt;meta name="supported-color-schemes" content="light dark"&gt;
                      </div>
                      <p class="text-sm text-gray-600 mt-2">
                        Signals to modern clients that the email has its own dark mode styles defined
                        <a href="https://github.com/matthieuSolente/email-darkmode" class="citation" target="_blank">[113]</a>.
                      </p>
                    </div>

                    <div>
                      <h5 class="font-medium mb-2">2. Standard Media Query</h5>
                      <div class="code-block">
                        @media (prefers-color-scheme: dark) {
                        body {
                        background-color: #1a1a1a !important;
                        color: #e0e0e0 !important;
                        }
                        a {
                        color: #bb86fc !important;
                        }
                        }
                      </div>
                    </div>

                    <div>
                      <h5 class="font-medium mb-2">3. Gmail-Specific Targeting</h5>
                      <div class="code-block">
                        [data-ogsc] .body {
                        background-color: #1a1a1a !important;
                        color: #e0e0e0 !important;
                        }
                        [data-ogsc] a {
                        color: #bb86fc !important;
                        }
                      </div>
                      <p class="text-sm text-gray-600 mt-2">
                        Targets Gmail's proprietary dark mode implementation where it adds the
                        [data-ogsc] attribute to the body element.
                      </p>
                    </div>

                    <div>
                      <h5 class="font-medium mb-2">4. Apple Mail Data Detector Override</h5>
                      <div class="code-block">
                        a[x-apple-data-detectors] {
                        color: #bb86fc !important;
                        text-decoration: none !important;
                        }
                      </div>
                      <p class="text-sm text-gray-600 mt-2">
                        Prevents Apple Mail from automatically styling phone numbers, addresses,
                        and dates with default blue links
                        <a href="https://www.litmus.com/blog/how-to-remove-blue-links-in-html-emails" class="citation" target="_blank">[11]</a>.
                      </p>
                    </div>
                  </div>
                </div>

                <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                  <h4 class="font-semibold text-green-800 mb-2">Expected Outcome</h4>
                  <p class="text-sm text-green-700">
                    Consistent dark mode rendering across 85%+ of email clients with controlled
                    color schemes that maintain brand identity and readability.
                  </p>
                </div>
              </div>
            </div>
          </div>

          <!-- Job Titles Wrapping Fix -->
          <div id="job-titles" class="mb-16">
            <div class="bg-white rounded-lg shadow-sm border">
              <div class="p-6 border-b border-gray-200">
                <div class="flex items-center justify-between">
                  <div>
                    <h3 class="text-xl font-semibold">Job Titles Line Wrapping</h3>
                    <p class="text-gray-600 mt-1">Preventing footer text from breaking onto multiple lines</p>
                  </div>
                  <span class="priority-badge priority-p1">P1 Issue</span>
                </div>
              </div>

              <div class="p-6 space-y-6">
                <div>
                  <h4 class="font-semibold mb-2">Problem Analysis</h4>
                  <p class="text-gray-700 mb-4">
                    The job titles in the footer (".roles" class) are wrapping onto multiple lines
                    on mobile devices and narrow viewports, disrupting the intended single-line layout.
                  </p>

                  <div class="bg-red-50 border border-red-200 rounded-lg p-4">
                    <h5 class="font-semibold text-red-800 mb-2">Impact:</h5>
                    <ul class="text-sm text-red-700 space-y-1">
                      <li>• Broken visual hierarchy in email signature</li>
                      <li>• Unprofessional appearance on mobile devices</li>
                      <li>• Reduced brand credibility</li>
                      <li>• Layout instability in responsive designs</li>
                    </ul>
                  </div>
                </div>

                <div>
                  <h4 class="font-semibold mb-2">Surgical Fix Implementation</h4>
                  <div class="space-y-4">
                    <div>
                      <h5 class="font-medium mb-2">CSS Solution</h5>
                      <div class="code-block">
                        .roles {
                        white-space: nowrap;
                        overflow: hidden;
                        text-overflow: ellipsis;
                        }

                        @media screen and (max-width: 480px) {
                        .roles {
                        font-size: 12px; /* Responsive scaling */
                        }
                        }
                      </div>
                      <p class="text-sm text-gray-600 mt-2">
                        The
                        <code>white-space: nowrap</code> property forces the text to remain on a single line,
                        while the media query ensures it scales appropriately on mobile devices.
                      </p>
                    </div>

                    <div>
                      <h5 class="font-medium mb-2">HTML Enhancement</h5>
                      <div class="code-block">
                        &lt;span class="roles"&gt;
                        Role 1&nbsp;|&nbsp;Role 2&nbsp;|&nbsp;Role 3
                        &lt;/span&gt;
                      </div>
                      <p class="text-sm text-gray-600 mt-2">
                        Using non-breaking spaces (&nbsp;) between elements ensures the entire
                        job title block is treated as a single unbreakable unit.
                      </p>
                    </div>
                  </div>
                </div>

                <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                  <h4 class="font-semibold text-blue-800 mb-2">Fallback Strategy</h4>
                  <p class="text-sm text-blue-700">
                    In clients that don't support
                    <code>white-space: nowrap</code>, the fallback is graceful wrapping
                    with maintained readability. The design degradation is acceptable compared to forced overflow.
                  </p>
                </div>
              </div>
            </div>
          </div>

          <!-- Umwelt Panel Font Scaling -->
          <div id="font-scaling" class="mb-16">
            <div class="bg-white rounded-lg shadow-sm border">
              <div class="p-6 border-b border-gray-200">
                <div class="flex items-center justify-between">
                  <div>
                    <h3 class="text-xl font-semibold">Umwelt Panel Font Scaling</h3>
                    <p class="text-gray-600 mt-1">Controlling font inflation on small screens and high DPI displays</p>
                  </div>
                  <span class="priority-badge priority-p1">P1 Issue</span>
                </div>
              </div>

              <div class="p-6 space-y-6">
                <div>
                  <h4 class="font-semibold mb-2">Root Cause Analysis</h4>
                  <p class="text-gray-700 mb-4">
                    The Umwelt panel text (".umwelt-p1", ".umwelt-p2") experiences font size inflation
                    on small screens and in Outlook with high DPI settings. This disrupts the visual hierarchy
                    as the text becomes disproportionately large compared to body content.
                  </p>

                  <div class="bg-orange-50 border border-orange-200 rounded-lg p-4">
                    <h5 class="font-semibold text-orange-800 mb-2">Technical Challenges:</h5>
                    <ul class="text-sm text-orange-700 space-y-1">
                      <li>• Outlook's DPI scaling behavior on high-resolution displays</li>
                      <li>• Mobile client font size adjustments</li>
                      <li>• Inconsistent viewport handling across clients</li>
                      <li>• Legacy rendering engines interpreting CSS differently</li>
                    </ul>
                  </div>
                </div>

                <div>
                  <h4 class="font-semibold mb-2">Multi-Client Solution</h4>
                  <div class="space-y-4">
                    <div>
                      <h5 class="font-medium mb-2">1. Responsive Font Control</h5>
                      <div class="code-block">
                        .umwelt-p1, .umwelt-p2 {
                        font-size: 16px; /* Base size */
                        line-height: 1.4;
                        }

                        @media screen and (max-width: 480px) {
                        .umwelt-p1, .umwelt-p2 {
                        font-size: 14px !important; /* Controlled mobile size */
                        }
                        }
                      </div>
                    </div>

                    <div>
                      <h5 class="font-medium mb-2">2. Outlook-Specific DPI Fix</h5>
                      <div class="code-block">
                        &lt;!--[if mso]&gt;
                        &lt;style&gt;
                        .umwelt-p1, .umwelt-p2 {
                        font-size: 16px !important;
                        mso-style-textfill-type: none;
                        }
                        &lt;/style&gt;
                        &lt;![endif]--&gt;
                      </div>
                      <p class="text-sm text-gray-600 mt-2">
                        Conditional comments target Outlook specifically to control its DPI scaling behavior.
                      </p>
                    </div>

                    <div>
                      <h5 class="font-medium mb-2">3. Container Stability</h5>
                      <div class="code-block">
                        .umwelt-panel {
                        min-height: 120px; /* Prevent layout shifts */
                        height: auto !important;
                        overflow: hidden;
                        }
                      </div>
                    </div>
                  </div>
                </div>

                <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                  <h4 class="font-semibold text-green-800 mb-2">Client Coverage</h4>
                  <p class="text-sm text-green-700">
                    This solution addresses 95% of font scaling issues across Tier-1 and Tier-2 clients,
                    with graceful degradation for legacy clients that don't support media queries.
                  </p>
                </div>
              </div>
            </div>
          </div>

          <!-- Outlook Rendering Issues -->
          <div id="outlook-issues" class="mb-16">
            <div class="bg-white rounded-lg shadow-sm border">
              <div class="p-6 border-b border-gray-200">
                <div class="flex items-center justify-between">
                  <div>
                    <h3 class="text-xl font-semibold">Outlook Line-Height & Image Clipping</h3>
                    <p class="text-gray-600 mt-1">Preventing text and image truncation in Outlook's rendering engine</p>
                  </div>
                  <span class="priority-badge priority-p2">P2 Issue</span>
                </div>
              </div>

              <div class="p-6 space-y-6">
                <div>
                  <h4 class="font-semibold mb-2">Outlook's Rendering Quirks</h4>
                  <p class="text-gray-700 mb-4">
                    Microsoft Outlook uses a Microsoft Word-based rendering engine that can miscalculate
                    element dimensions, leading to text being cut off at line ends and images displaying
                    partially or not at all.
                  </p>

                  <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                    <h5 class="font-semibold text-blue-800 mb-2">Common Symptoms:</h5>
                    <ul class="text-sm text-blue-700 space-y-1">
                      <li>• Text clipped at the bottom of lines</li>
                      <li>• Images showing only top portions</li>
                      <li>• Inconsistent spacing between elements</li>
                      <li>• Table cell height miscalculations</li>
                    </ul>
                  </div>
                </div>

                <div>
                  <h4 class="font-semibold mb-2">Definitive Fix Implementation</h4>
                  <div class="space-y-4">
                    <div>
                      <h5 class="font-medium mb-2">1. Explicit Line-Height Control</h5>
                      <div class="code-block">
                        td {
                        line-height: 1.5 !important;
                        mso-line-height-rule: exactly;
                        }

                        p, span, a {
                        line-height: inherit !important;
                        }
                      </div>
                      <p class="text-sm text-gray-600 mt-2">
                        The
                        <code>mso-line-height-rule</code> property ensures Outlook respects the specified line height.
                      </p>
                    </div>

                    <div>
                      <h5 class="font-medium mb-2">2. Image Dimension Specification</h5>
                      <div class="code-block">
                        &lt;img src="image.jpg" width="200" height="100" alt="Description"
                        style="display: block;" /&gt;

                        /* CSS fallback */
                        img {
                        display: block !important;
                        max-width: 100% !important;
                        height: auto !important;
                        }
                      </div>
                      <p class="text-sm text-gray-600 mt-2">
                        Always specify both width and height attributes in HTML, with CSS fallbacks
                        for responsive behavior.
                      </p>
                    </div>

                    <div>
                      <h5 class="font-medium mb-2">3. Table Cell Padding Control</h5>
                      <div class="code-block">
                        td {
                        padding: 20px !important;
                        mso-padding-alt: 20px;
                        }

                        /* Prevent padding doubling */
                        table {
                        border-collapse: collapse;
                        mso-table-lspace: 0pt;
                        mso-table-rspace: 0pt;
                        }
                      </div>
                    </div>
                  </div>
                </div>

                <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                  <h4 class="font-semibold text-green-800 mb-2">Best Practice Implementation</h4>
                  <p class="text-sm text-green-700">
                    These fixes represent email development best practices that improve rendering
                    across all clients, not just Outlook. The explicit dimension approach ensures
                    predictable layout calculations.
                  </p>
                </div>
              </div>
            </div>
          </div>

          <!-- Inline Color Styling -->
          <div id="inline-styles" class="mb-16">
            <div class="bg-white rounded-lg shadow-sm border">
              <div class="p-6 border-b border-gray-200">
                <div class="flex items-center justify-between">
                  <div>
                    <h3 class="text-xl font-semibold">Inline Color Styling Migration</h3>
                    <p class="text-gray-600 mt-1">Transitioning from inline styles to class-based theming</p>
                  </div>
                  <span class="priority-badge priority-p2">P2 Issue</span>
                </div>
              </div>

              <div class="p-6 space-y-6">
                <div>
                  <h4 class="font-semibold mb-2">Maintainability Challenge</h4>
                  <p class="text-gray-700 mb-4">
                    Inline color styles create maintenance overhead and inconsistencies, especially
                    when implementing dark mode themes. The current template relies heavily on
                    inline styles that need to be managed individually.
                  </p>

                  <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                    <h5 class="font-semibold text-yellow-800 mb-2">Problems with Inline Styles:</h5>
                    <ul class="text-sm text-yellow-700 space-y-1">
                      <li>• Difficult to maintain and update color schemes</li>
                      <li>• Inconsistent application across elements</li>
                      <li>• Harder to override for dark mode</li>
                      <li>• Bloated HTML with repetitive style declarations</li>
                    </ul>
                  </div>
                </div>

                <div>
                  <h4 class="font-semibold mb-2">Class-Based Theming Solution</h4>
                  <div class="space-y-4">
                    <div>
                      <h5 class="font-medium mb-2">1. CSS Class Definitions</h5>
                      <div class="code-block">
                        /* Color System */
                        .text-primary { color: #1f2937 !important; }
                        .text-secondary { color: #6b7280 !important; }
                        .text-accent { color: #7c3aed !important; }
                        .bg-primary { background-color: #ffffff !important; }
                        .bg-secondary { background-color: #f9fafb !important; }

                        /* Dark Mode Variants */
                        @media (prefers-color-scheme: dark) {
                        .text-primary { color: #e5e7eb !important; }
                        .text-secondary { color: #9ca3af !important; }
                        .text-accent { color: #a78bfa !important; }
                        .bg-primary { background-color: #111827 !important; }
                        }
                      </div>
                    </div>

                    <div>
                      <h5 class="font-medium mb-2">2. HTML Implementation</h5>
                      <div class="code-block">
                        <!-- Before -->
                        &lt;p style="color: #1f2937;"&gt;Text content&lt;/p&gt;
                        &lt;div style="background-color: #ffffff;"&gt;...&lt;/div&gt;

                        <!-- After -->
                        &lt;p class="text-primary"&gt;Text content&lt;/p&gt;
                        &lt;div class="bg-primary"&gt;...&lt;/div&gt;
                      </div>
                    </div>

                    <div>
                      <h5 class="font-medium mb-2">3. Dark Mode Integration</h5>
                      <div class="code-block">
                        /* Gmail Dark Mode */
                        [data-ogsc] .text-primary { color: #e5e7eb !important; }
                        [data-ogsc] .bg-primary { background-color: #111827 !important; }

                        /* Outlook Specific */
                        <!--[if mso]>
                        <style>
                        .text-primary { color: #1f2937 !important; }
                        </style>
                        <![endif]-->
                      </div>
                    </div>
                  </div>
                </div>

                <div class="bg-purple-50 border border-purple-200 rounded-lg p-4">
                  <h4 class="font-semibold text-purple-800 mb-2">Benefits of Class-Based Approach</h4>
                  <ul class="text-sm text-purple-700 space-y-1">
                    <li>• Centralized color management and theming</li>
                    <li>• Consistent application across all elements</li>
                    <li>• Easier dark mode implementation and maintenance</li>
                    <li>• Cleaner, more semantic HTML structure</li>
                    <li>• Better performance with smaller file sizes</li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Sanity Checklist -->
      <section id="sanity-checklist" class="py-16 px-8 bg-white">
        <div class="max-w-6xl mx-auto">
          <div class="section-header">
            <h2 class="serif text-3xl font-bold">S3 — Sanity Checklist</h2>
            <p class="text-gray-600 mt-2">Pre-send validation points to ensure consistent rendering.</p>
          </div>

          <div class="grid lg:grid-cols-2 gap-8">
            <!-- Pre-Send Validation -->
            <div class="space-y-6">
              <div class="insight-card">
                <h3 class="text-lg font-semibold mb-4">Pre-Send Validation</h3>
                <div class="space-y-4">
                  <div class="flex items-start space-x-3">
                    <div class="flex-shrink-0 w-6 h-6 bg-green-100 rounded-full flex items-center justify-center">
                      <i class="fas fa-check text-green-600 text-xs"></i>
                    </div>
                    <div>
                      <h4 class="font-medium">Hidden Preheader Text</h4>
                      <p class="text-sm text-gray-600">Ensure preheader text is present and properly hidden with CSS display: none;</p>
                    </div>
                  </div>

                  <div class="flex items-start space-x-3">
                    <div class="flex-shrink-0 w-6 h-6 bg-green-100 rounded-full flex items-center justify-center">
                      <i class="fas fa-check text-green-600 text-xs"></i>
                    </div>
                    <div>
                      <h4 class="font-medium">Link Styling Hacks</h4>
                      <p class="text-sm text-gray-600">Verify
                        <code>&lt;u&gt;</code> hack for link styling is intact and functioning
                      </p>
                    </div>
                  </div>

                  <div class="flex items-start space-x-3">
                    <div class="flex-shrink-0 w-6 h-6 bg-green-100 rounded-full flex items-center justify-center">
                      <i class="fas fa-check text-green-600 text-xs"></i>
                    </div>
                    <div>
                      <h4 class="font-medium">Image Dimensions</h4>
                      <p class="text-sm text-gray-600">Confirm all images have explicit width and height attributes</p>
                    </div>
                  </div>

                  <div class="flex items-start space-x-3">
                    <div class="flex-shrink-0 w-6 h-6 bg-green-100 rounded-full flex items-center justify-center">
                      <i class="fas fa-check text-green-600 text-xs"></i>
                    </div>
                    <div>
                      <h4 class="font-medium">Max-Width Wrapper</h4>
                      <p class="text-sm text-gray-600">Check that max-width constraints are functioning correctly</p>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Dark Mode & Responsiveness -->
            <div class="space-y-6">
              <div class="insight-card">
                <h3 class="text-lg font-semibold mb-4">Dark Mode & Responsiveness</h3>
                <div class="space-y-4">
                  <div class="flex items-start space-x-3">
                    <div class="flex-shrink-0 w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center">
                      <i class="fas fa-mobile-alt text-blue-600 text-xs"></i>
                    </div>
                    <div>
                      <h4 class="font-medium">480px Breakpoint</h4>
                      <p class="text-sm text-gray-600">Verify 480px breakpoint consistency across all responsive style blocks</p>
                    </div>
                  </div>

                  <div class="flex items-start space-x-3">
                    <div class="flex-shrink-0 w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center">
                      <i class="fas fa-palette text-blue-600 text-xs"></i>
                    </div>
                    <div>
                      <h4 class="font-medium">Dark Mode Style Blocks</h4>
                      <p class="text-sm text-gray-600">Ensure dark mode/OGSC/Proton style blocks are synchronized</p>
                    </div>
                  </div>

                  <div class="flex items-start space-x-3">
                    <div class="flex-shrink-0 w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center">
                      <i class="fas fa-link text-blue-600 text-xs"></i>
                    </div>
                    <div>
                      <h4 class="font-medium">Link Color Verification</h4>
                      <p class="text-sm text-gray-600">Test cross-client link colors in both light and dark modes</p>
                    </div>
                  </div>

                  <div class="flex items-start space-x-3">
                    <div class="flex-shrink-0 w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center">
                      <i class="fas fa-eye text-blue-600 text-xs"></i>
                    </div>
                    <div>
                      <h4 class="font-medium">Viewport Meta Tag</h4>
                      <p class="text-sm text-gray-600">Confirm viewport meta tag is present and correctly configured</p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Implementation Timeline -->
          <div class="mt-12 bg-gray-50 rounded-lg p-6">
            <h3 class="text-lg font-semibold mb-4">Recommended Implementation Timeline</h3>
            <div class="space-y-4">
              <div class="flex items-center space-x-4">
                <div class="flex-shrink-0 w-8 h-8 bg-red-500 text-white rounded-full flex items-center justify-center text-sm font-bold">1</div>
                <div class="flex-1">
                  <h4 class="font-medium">Immediate (Week 1)</h4>
                  <p class="text-sm text-gray-600">Implement dark mode fixes and job title wrapping solutions</p>
                </div>
              </div>
              <div class="flex items-center space-x-4">
                <div class="flex-shrink-0 w-8 h-8 bg-orange-500 text-white rounded-full flex items-center justify-center text-sm font-bold">2</div>
                <div class="flex-1">
                  <h4 class="font-medium">Short-term (Week 2)</h4>
                  <p class="text-sm text-gray-600">Address Umwelt panel scaling and Outlook rendering issues</p>
                </div>
              </div>
              <div class="flex items-center space-x-4">
                <div class="flex-shrink-0 w-8 h-8 bg-yellow-500 text-white rounded-full flex items-center justify-center text-sm font-bold">3</div>
                <div class="flex-1">
                  <h4 class="font-medium">Medium-term (Week 3)</h4>
                  <p class="text-sm text-gray-600">Migrate to class-based styling system and perform comprehensive testing</p>
                </div>
              </div>
              <div class="flex items-center space-x-4">
                <div class="flex-shrink-0 w-8 h-8 bg-green-500 text-white rounded-full flex items-center justify-center text-sm font-bold">4</div>
                <div class="flex-1">
                  <h4 class="font-medium">Long-term (Ongoing)</h4>
                  <p class="text-sm text-gray-600">Monitor performance and implement maintenance updates</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Implementation Guide -->
      <section id="implementation" class="py-16 px-8 bg-gray-50">
        <div class="max-w-6xl mx-auto">
          <div class="section-header">
            <h2 class="serif text-3xl font-bold">Implementation Guide</h2>
            <p class="text-gray-600 mt-2">Step-by-step deployment strategy for production readiness.</p>
          </div>

          <!-- Email Client Compatibility Diagram -->
          <div class="mb-12">
            <h3 class="text-xl font-semibold mb-6 text-center">Email Client Compatibility Matrix</h3>
            <div class="mermaid-container">
              <div class="mermaid-controls">
                <button class="mermaid-control-btn zoom-in" title="放大">
                  <i class="fas fa-search-plus"></i>
                </button>
                <button class="mermaid-control-btn zoom-out" title="缩小">
                  <i class="fas fa-search-minus"></i>
                </button>
                <button class="mermaid-control-btn reset-zoom" title="重置">
                  <i class="fas fa-expand-arrows-alt"></i>
                </button>
                <button class="mermaid-control-btn fullscreen" title="全屏查看">
                  <i class="fas fa-expand"></i>
                </button>
              </div>
              <div class="mermaid" id="compatibility-diagram">
                graph TD
                A["HTML Email Template"] --> B["Tier-1 Clients"]
                A --> C["Tier-2 Clients"]
                A --> D["Tier-3 Clients"]

                B --> E["Apple Mail
                <br />iOS/macOS"]
                B --> F["Gmail
                <br />Web + Mobile"]
                B --> G["Outlook Desktop"]
                B --> H["Outlook.com"]
                B --> I["ProtonMail"]

                C --> J["Yahoo Mail"]
                C --> K["GMX"]
                C --> L["Android Webmail"]

                D --> M["Legacy Android"]
                D --> N["Windows Mail Legacy"]

                E --> O["Dark Mode Fix Required"]
                F --> O
                G --> P["Outlook Specific Fixes"]
                H --> Q["Standard CSS"]

                style A fill:#fef3c7,stroke:#d97706,stroke-width:2px,color:#92400e
                style B fill:#dbeafe,stroke:#2563eb,stroke-width:2px,color:#1d4ed8
                style C fill:#dcfce7,stroke:#16a34a,stroke-width:2px,color:#15803d
                style D fill:#f3e8ff,stroke:#9333ea,stroke-width:2px,color:#7c3aed
                style O fill:#fee2e2,stroke:#dc2626,stroke-width:2px,color:#991b1b
                style P fill:#fee2e2,stroke:#dc2626,stroke-width:2px,color:#991b1b
                style Q fill:#f0fdf4,stroke:#16a34a,stroke-width:2px,color:#15803d
              </div>
            </div>
          </div>

          <div class="grid lg:grid-cols-3 gap-8">
            <!-- Phase 1 -->
            <div class="bg-white rounded-lg shadow-sm border">
              <div class="bg-red-50 border-b border-red-200 p-4">
                <h3 class="text-lg font-semibold text-red-800">Phase 1: Critical Fixes</h3>
                <p class="text-sm text-red-600 mt-1">Address P1 issues affecting layout and readability</p>
              </div>
              <div class="p-6 space-y-4">
                <div>
                  <h4 class="font-medium mb-2">Dark Mode Implementation</h4>
                  <ul class="text-sm text-gray-600 space-y-1">
                    <li>• Add meta tags for color-scheme</li>
                    <li>• Implement media queries</li>
                    <li>• Add Gmail [data-ogsc] targeting</li>
                    <li>• Test across Tier-1 clients</li>
                  </ul>
                </div>
                <div>
                  <h4 class="font-medium mb-2">Job Title Wrapping</h4>
                  <ul class="text-sm text-gray-600 space-y-1">
                    <li>• Apply white-space: nowrap</li>
                    <li>• Add non-breaking spaces</li>
                    <li>• Implement responsive scaling</li>
                    <li>• Test on mobile devices</li>
                  </ul>
                </div>
                <div class="bg-red-50 border border-red-200 rounded-lg p-3">
                  <p class="text-sm text-red-700">
                    <strong>Timeline:</strong> 3-5 days
                    <br>
                    <strong>Priority:</strong> Critical
                  </p>
                </div>
              </div>
            </div>

            <!-- Phase 2 -->
            <div class="bg-white rounded-lg shadow-sm border">
              <div class="bg-orange-50 border-b border-orange-200 p-4">
                <h3 class="text-lg font-semibold text-orange-800">Phase 2: Layout Stability</h3>
                <p class="text-sm text-orange-600 mt-1">Address font scaling and Outlook rendering</p>
              </div>
              <div class="p-6 space-y-4">
                <div>
                  <h4 class="font-medium mb-2">Umwelt Panel Scaling</h4>
                  <ul class="text-sm text-gray-600 space-y-1">
                    <li>• Implement responsive font controls</li>
                    <li>• Add Outlook-specific fixes</li>
                    <li>• Test high DPI scenarios</li>
                    <li>• Verify hierarchy preservation</li>
                  </ul>
                </div>
                <div>
                  <h4 class="font-medium mb-2">Outlook Rendering</h4>
                  <ul class="text-sm text-gray-600 space-y-1">
                    <li>• Set explicit line-heights</li>
                    <li>• Define image dimensions</li>
                    <li>• Add VML fallbacks if needed</li>
                    <li>• Test in Outlook versions</li>
                  </ul>
                </div>
                <div class="bg-orange-50 border border-orange-200 rounded-lg p-3">
                  <p class="text-sm text-orange-700">
                    <strong>Timeline:</strong> 2-3 days
                    <br>
                    <strong>Priority:</strong> High
                  </p>
                </div>
              </div>
            </div>

            <!-- Phase 3 -->
            <div class="bg-white rounded-lg shadow-sm border">
              <div class="bg-blue-50 border-b border-blue-200 p-4">
                <h3 class="text-lg font-semibold text-blue-800">Phase 3: Optimization</h3>
                <p class="text-sm text-blue-600 mt-1">Migrate to class-based styling and testing</p>
              </div>
              <div class="p-6 space-y-4">
                <div>
                  <h4 class="font-medium mb-2">Class-Based Theming</h4>
                  <ul class="text-sm text-gray-600 space-y-1">
                    <li>• Create color system classes</li>
                    <li>• Migrate inline styles</li>
                    <li>• Implement dark mode variants</li>
                    <li>• Optimize CSS structure</li>
                  </ul>
                </div>
                <div>
                  <h4 class="font-medium mb-2">Comprehensive Testing</h4>
                  <ul class="text-sm text-gray-600 space-y-1">
                    <li>• Cross-client verification</li>
                    <li>• Dark mode testing suite</li>
                    <li>• Mobile responsiveness checks</li>
                    <li>• Performance optimization</li>
                  </ul>
                </div>
                <div class="bg-blue-50 border border-blue-200 rounded-lg p-3">
                  <p class="text-sm text-blue-700">
                    <strong>Timeline:</strong> 3-4 days
                    <br>
                    <strong>Priority:</strong> Medium
                  </p>
                </div>
              </div>
            </div>
          </div>

          <!-- Success Metrics -->
          <div class="mt-12 bg-white rounded-lg shadow-sm border">
            <div class="p-6">
              <h3 class="text-lg font-semibold mb-4">Success Metrics & Monitoring</h3>
              <div class="grid md:grid-cols-4 gap-4">
                <div class="text-center p-4 bg-green-50 rounded-lg">
                  <div class="text-2xl font-bold text-green-600">95%</div>
                  <div class="text-sm text-green-700">Cross-client compatibility</div>
                </div>
                <div class="text-center p-4 bg-blue-50 rounded-lg">
                  <div class="text-2xl font-bold text-blue-600">100%</div>
                  <div class="text-sm text-blue-700">Dark mode functionality</div>
                </div>
                <div class="text-center p-4 bg-purple-50 rounded-lg">
                  <div class="text-2xl font-bold text-purple-600">0</div>
                  <div class="text-sm text-purple-700">Layout breakage reports</div>
                </div>
                <div class="text-center p-4 bg-orange-50 rounded-lg">
                  <div class="text-2xl font-bold text-orange-600">15%</div>
                  <div class="text-sm text-orange-700">File size reduction</div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
    </main>

    <script>
        // Initialize Mermaid
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default',
            themeVariables: {
                // Primary colors with high contrast
                primaryColor: '#f8fafc',
                primaryTextColor: '#1f2937',
                primaryBorderColor: '#374151',
                
                // Secondary colors
                secondaryColor: '#f1f5f9',
                secondaryTextColor: '#1f2937',
                secondaryBorderColor: '#64748b',
                
                // Tertiary colors
                tertiaryColor: '#ffffff',
                tertiaryTextColor: '#1f2937',
                tertiaryBorderColor: '#94a3b8',
                
                // Background and text
                background: '#ffffff',
                mainBkg: '#f8fafc',
                secondBkg: '#f1f5f9',
                tertiaryBkg: '#ffffff',
                
                // Lines and edges
                lineColor: '#64748b',
                edgeLabelBackground: '#ffffff',
                
                // Node-specific colors for better contrast
                nodeBkg: '#f8fafc',
                nodeTextColor: '#1f2937',
                nodeBorder: '#374151',
                
                // Different node types with high contrast
                cScale0: '#fef3c7', // Light yellow
                cScale1: '#dbeafe', // Light blue  
                cScale2: '#dcfce7', // Light green
                cScale3: '#fce7f3', // Light pink
                cScale4: '#f3e8ff', // Light purple
                cScale5: '#fee2e2', // Light red
                
                // Text colors for different scales
                cScale0Text: '#92400e', // Dark yellow text
                cScale1Text: '#1d4ed8', // Dark blue text
                cScale2Text: '#15803d', // Dark green text
                cScale3Text: '#be185d', // Dark pink text
                cScale4Text: '#7c3aed', // Dark purple text
                cScale5Text: '#dc2626'  // Dark red text
            },
            flowchart: {
                useMaxWidth: true,
                htmlLabels: true,
                curve: 'basis',
                padding: 30,
                nodeSpacing: 50,
                rankSpacing: 80,
                diagramPadding: 20
            },
            fontSize: 14,
            fontFamily: 'Inter, sans-serif'
        });

        // Initialize Mermaid Controls for zoom and pan
        function initializeMermaidControls() {
            const containers = document.querySelectorAll('.mermaid-container');

            containers.forEach(container => {
            const mermaidElement = container.querySelector('.mermaid');
            let scale = 1;
            let isDragging = false;
            let startX, startY, translateX = 0, translateY = 0;

            // 触摸相关状态
            let isTouch = false;
            let touchStartTime = 0;
            let initialDistance = 0;
            let initialScale = 1;
            let isPinching = false;

            // Zoom controls
            const zoomInBtn = container.querySelector('.zoom-in');
            const zoomOutBtn = container.querySelector('.zoom-out');
            const resetBtn = container.querySelector('.reset-zoom');
            const fullscreenBtn = container.querySelector('.fullscreen');

            function updateTransform() {
                mermaidElement.style.transform = `translate(${translateX}px, ${translateY}px) scale(${scale})`;

                if (scale > 1) {
                container.classList.add('zoomed');
                } else {
                container.classList.remove('zoomed');
                }

                mermaidElement.style.cursor = isDragging ? 'grabbing' : 'grab';
            }

            if (zoomInBtn) {
                zoomInBtn.addEventListener('click', () => {
                scale = Math.min(scale * 1.25, 4);
                updateTransform();
                });
            }

            if (zoomOutBtn) {
                zoomOutBtn.addEventListener('click', () => {
                scale = Math.max(scale / 1.25, 0.3);
                if (scale <= 1) {
                    translateX = 0;
                    translateY = 0;
                }
                updateTransform();
                });
            }

            if (resetBtn) {
                resetBtn.addEventListener('click', () => {
                scale = 1;
                translateX = 0;
                translateY = 0;
                updateTransform();
                });
            }

            if (fullscreenBtn) {
                fullscreenBtn.addEventListener('click', () => {
                if (container.requestFullscreen) {
                    container.requestFullscreen();
                } else if (container.webkitRequestFullscreen) {
                    container.webkitRequestFullscreen();
                } else if (container.msRequestFullscreen) {
                    container.msRequestFullscreen();
                }
                });
            }

            // Mouse Events
            mermaidElement.addEventListener('mousedown', (e) => {
                if (isTouch) return; // 如果是触摸设备，忽略鼠标事件

                isDragging = true;
                startX = e.clientX - translateX;
                startY = e.clientY - translateY;
                mermaidElement.style.cursor = 'grabbing';
                updateTransform();
                e.preventDefault();
            });

            document.addEventListener('mousemove', (e) => {
                if (isDragging && !isTouch) {
                translateX = e.clientX - startX;
                translateY = e.clientY - startY;
                updateTransform();
                }
            });

            document.addEventListener('mouseup', () => {
                if (isDragging && !isTouch) {
                isDragging = false;
                mermaidElement.style.cursor = 'grab';
                updateTransform();
                }
            });

            document.addEventListener('mouseleave', () => {
                if (isDragging && !isTouch) {
                isDragging = false;
                mermaidElement.style.cursor = 'grab';
                updateTransform();
                }
            });

            // 获取两点之间的距离
            function getTouchDistance(touch1, touch2) {
                return Math.hypot(
                touch2.clientX - touch1.clientX,
                touch2.clientY - touch1.clientY
                );
            }

            // Touch Events - 触摸事件处理
            mermaidElement.addEventListener('touchstart', (e) => {
                isTouch = true;
                touchStartTime = Date.now();

                if (e.touches.length === 1) {
                // 单指拖动
                isPinching = false;
                isDragging = true;

                const touch = e.touches[0];
                startX = touch.clientX - translateX;
                startY = touch.clientY - translateY;

                } else if (e.touches.length === 2) {
                // 双指缩放
                isPinching = true;
                isDragging = false;

                const touch1 = e.touches[0];
                const touch2 = e.touches[1];
                initialDistance = getTouchDistance(touch1, touch2);
                initialScale = scale;
                }

                e.preventDefault();
            }, { passive: false });

            mermaidElement.addEventListener('touchmove', (e) => {
                if (e.touches.length === 1 && isDragging && !isPinching) {
                // 单指拖动
                const touch = e.touches[0];
                translateX = touch.clientX - startX;
                translateY = touch.clientY - startY;
                updateTransform();

                } else if (e.touches.length === 2 && isPinching) {
                // 双指缩放
                const touch1 = e.touches[0];
                const touch2 = e.touches[1];
                const currentDistance = getTouchDistance(touch1, touch2);

                if (initialDistance > 0) {
                    const newScale = Math.min(Math.max(
                    initialScale * (currentDistance / initialDistance),
                    0.3
                    ), 4);
                    scale = newScale;
                    updateTransform();
                }
                }

                e.preventDefault();
            }, { passive: false });

            mermaidElement.addEventListener('touchend', (e) => {
                // 重置状态
                if (e.touches.length === 0) {
                isDragging = false;
                isPinching = false;
                initialDistance = 0;

                // 延迟重置isTouch，避免鼠标事件立即触发
                setTimeout(() => {
                    isTouch = false;
                }, 100);
                } else if (e.touches.length === 1 && isPinching) {
                // 从双指变为单指，切换为拖动模式
                isPinching = false;
                isDragging = true;

                const touch = e.touches[0];
                startX = touch.clientX - translateX;
                startY = touch.clientY - translateY;
                }

                updateTransform();
            });

            mermaidElement.addEventListener('touchcancel', (e) => {
                isDragging = false;
                isPinching = false;
                initialDistance = 0;

                setTimeout(() => {
                isTouch = false;
                }, 100);

                updateTransform();
            });

            // Enhanced wheel zoom with better center point handling
            container.addEventListener('wheel', (e) => {
                e.preventDefault();
                const rect = container.getBoundingClientRect();
                const centerX = rect.width / 2;
                const centerY = rect.height / 2;

                const delta = e.deltaY > 0 ? 0.9 : 1.1;
                const newScale = Math.min(Math.max(scale * delta, 0.3), 4);

                // Adjust translation to zoom towards center
                if (newScale !== scale) {
                const scaleDiff = newScale / scale;
                translateX = translateX * scaleDiff;
                translateY = translateY * scaleDiff;
                scale = newScale;

                if (scale <= 1) {
                    translateX = 0;
                    translateY = 0;
                }

                updateTransform();
                }
            });

            // Initialize display
            updateTransform();
            });
        }

        // Initialize interactions on page load
        initializeMermaidControls();

        // Smooth scrolling for TOC links
        document.querySelectorAll('.toc-link').forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                const targetId = this.getAttribute('href').substring(1);
                const targetElement = document.getElementById(targetId);
                
                if (targetElement) {
                    targetElement.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                    
                    // Update active link
                    document.querySelectorAll('.toc-link').forEach(l => l.classList.remove('active'));
                    this.classList.add('active');
                }
            });
        });

        // Update active TOC link on scroll
        window.addEventListener('scroll', function() {
            const sections = document.querySelectorAll('section[id]');
            const scrollPos = window.scrollY + 100;
            
            sections.forEach(section => {
                const sectionTop = section.offsetTop;
                const sectionHeight = section.offsetHeight;
                const sectionId = section.getAttribute('id');
                
                if (scrollPos >= sectionTop && scrollPos < sectionTop + sectionHeight) {
                    document.querySelectorAll('.toc-link').forEach(link => {
                        link.classList.remove('active');
                        if (link.getAttribute('href') === '#' + sectionId) {
                            link.classList.add('active');
                        }
                    });
                }
            });
        });

        // Mobile TOC toggle (for responsive)
        function toggleTOC() {
            const toc = document.querySelector('.toc-fixed');
            toc.classList.toggle('open');
        }

        // Add mobile menu button for smaller screens
        if (window.innerWidth <= 1024) {
            const mobileButton = document.createElement('button');
            mobileButton.innerHTML = '<i class="fas fa-bars"></i>';
            mobileButton.className = 'fixed top-4 left-4 z-50 bg-white p-2 rounded-lg shadow-lg lg:hidden';
            mobileButton.onclick = toggleTOC;
            document.body.appendChild(mobileButton);
        }
    </script>
  </body>

</html>